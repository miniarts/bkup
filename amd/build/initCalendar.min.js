define(["jquery","theme_bloom/jquery.scrollTo","theme_bloom/onDemand"],function(n,e,a){var t=function(){if(n(".ajaxcalendar").length>0){var e=n("#event_detail_box");e.on("click",".backto-calendar",function(e){e.preventDefault(),n(this).removeClass("move"),r(n(this).attr("href"),-60)}),n(".ajaxcalendar .has-event").on("click",".event-detail li, .day",function(a){a.preventDefault();var t=n(this).find("a"),o=t.attr("href"),l=o.substring(o.indexOf("#"));t.parents("td").addClass("loader"),e.find(".event").length>0&&e.find(".event").fadeOut(300),n.ajax({url:o,dataType:"html"}).done(function(a){var t="",i=e,d=n(a).find(".ajax-maincalendar");t="<h2>"+d.find(".controls span.current").html()+"</h2>",t+=d.find(".eventlist").html()+"<a href='#region-main' title='Back to Calendar' class='btn btn-primary backto-calendar'>Back to Calendar</a>",e.html(t),n(".btn.backto-calendar").ondemand(n(".ajaxcalendar"))," "!==l&&l!==o&&(i=n(l)),r(i,-60)})})}},r=function(e,a){n("body").scrollTo(e,500,{offset:function(){return{top:a,left:0}},onAfter:function(){n("td.loader").removeClass("loader")}})};return{init:function(){"use strict";n(document).ready(function(){t()})}}});