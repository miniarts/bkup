define(["jquery","core/custom_interaction_events","core/log"],function(e,t,a){var r={TOGGLE_REGION:'[data-region="drawer-toggle"]',TOGGLE_ACTION:'[data-action="toggle-drawer"]',TOGGLE_TARGET:"aria-controls",TOGGLE_SIDE:"left",BODY:"body"},n=function(){e(r.TOGGLE_REGION).length||a.debug("Page is missing a drawer region"),e(r.TOGGLE_ACTION).length||a.debug("Page is missing a drawer toggle link"),e(r.TOGGLE_REGION).each(function(t,a){var n=e(a).find(r.TOGGLE_ACTION),i=n.attr("aria-controls"),o=e(document.getElementById(i)),s="false"==n.attr("aria-expanded"),d=n.attr("data-side"),l=e(r.BODY);o.on("mousewheel DOMMouseScroll",this.preventPageScroll),s?n.attr("aria-expanded","false"):(l.addClass("drawer-open-"+d),n.attr("aria-expanded","true"))}.bind(this)),this.registerEventListeners(),e(document).width()<768&&this.closeAll()};return n.prototype.closeAll=function(){e(r.TOGGLE_REGION).each(function(t,a){var n=e(a).find(r.TOGGLE_ACTION),i=n.attr("data-side"),o=e(r.BODY),s=n.attr("aria-controls"),d=e(document.getElementById(s)),l=n.attr("data-preference");n.attr("aria-expanded","false"),o.removeClass("drawer-open-"+i),d.attr("aria-hidden","true"),d.addClass("closed"),M.util.set_user_preference(l,"false")})},n.prototype.toggleDrawer=function(t){var a=e(t.target).closest("[data-action=toggle-drawer]"),n=a.attr("aria-controls"),i=e(document.getElementById(n)),o=e(r.BODY),s=a.attr("data-side"),d=a.attr("data-preference");(o.addClass("drawer-ease"),"true"==a.attr("aria-expanded"))?(o.removeClass("drawer-open-"+s),a.attr("aria-expanded","false"),i.attr("aria-hidden","true"),i.addClass("closed"),M.util.set_user_preference(d,"false")):(e(document).width()<768&&this.closeAll(),a.attr("aria-expanded","true"),i.attr("aria-hidden","false"),i.focus(),o.addClass("drawer-open-"+s),i.removeClass("closed"),M.util.set_user_preference(d,"true"))},n.prototype.preventPageScroll=function(t){var a=t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.originalEvent.detail,r=this.scrollTop+e(this).outerHeight()-this.scrollHeight>=0,n=this.scrollTop<=0;(a<0&&r||a>0&&n)&&t.preventDefault()},n.prototype.registerEventListeners=function(){e(r.TOGGLE_ACTION).each(function(a,r){t.define(e(r),[t.events.activate]),e(r).on(t.events.activate,function(e,t){this.toggleDrawer(t.originalEvent),t.originalEvent.preventDefault()}.bind(this))}.bind(this))},{init:function(){return new n}}});